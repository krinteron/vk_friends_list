(function(){var e={2177:function(e,t,n){"use strict";n(9806),n(2856);var r=n(8935),i=n(150);n(44);r["default"].use(i.ZPm);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("FriendsComponent",{attrs:{connected:e.connected},on:{login:e.login,"export-list":e.log},model:{value:e.friendsList,callback:function(t){e.friendsList=t},expression:"friendsList"}})],1)},o=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("FriendsList",{attrs:{title:"friend list",label:e.connected?"logout":"login"},on:{click:function(t){return e.$emit("login")}}},[n("draggable",e._b({attrs:{list:e.friends,group:{name:"friends"}}},"draggable",e.dragOptions,!1),e._l(e.friends,(function(e){return n("UserCard",{key:e.id,attrs:{image:e.photo_100,name:e.first_name+" "+e.last_name}})})),1)],1),n("FriendsList",{attrs:{title:"selected friends",label:"export to console"},on:{click:function(t){return e.$emit("export-list")}}},[n("draggable",e._b({attrs:{list:e.selectedFriends,group:{name:"friends"}},on:{change:e.changeList}},"draggable",e.dragOptions,!1),e._l(e.selectedFriends,(function(e){return n("UserCard",{key:e.id,attrs:{image:e.photo_100,name:e.first_name+" "+e.last_name}})})),1)],1)],1)},c=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friends-item"},[n("header",{staticClass:"flex-container"},[n("p",[e._v(e._s(e.title))])]),e._t("default"),n("footer",{staticClass:"flex-container"},[n("b-button",{staticClass:"btn",attrs:{variant:"primary"},on:{click:function(t){return e.$emit("click")}}},[e._v(e._s(e.label))])],1)],2)},l=[],u={name:"FriendsList",props:{title:{type:String,default:"title"},label:{type:String,default:"button"}},emits:["click"]},f=u,p=n(1001),m=(0,p.Z)(f,d,l,!1,null,"732d5904",null),g=m.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-container"},[n("img",{attrs:{src:e.image,alt:"avatar"}}),n("p",[e._v(e._s(e.name))])])},_=[],v={name:"UserCard",props:{image:{type:String,required:!0},name:{type:String,required:!0}}},b=v,y=(0,p.Z)(b,h,_,!1,null,"e9337e5c",null),F=y.exports,k=n(6390),w=n.n(k),S={name:"FriendsComponent",components:{FriendsList:g,UserCard:F,draggable:w()},props:{value:{type:Object},connected:{type:Boolean,required:!0}},emits:["login","export-list"],computed:{dragOptions(){return{scrollSensitivity:80,forceFallback:!0,class:"main dragArea"}}},async created(){await this.$store.dispatch("getFriends"),this.importData()},data(){return{friends:[],selectedFriends:[]}},methods:{importData(){const{friends:e,selectedFriends:t}=JSON.parse(JSON.stringify(this.value));this.friends=e,this.selectedFriends=t,this.changeList()},changeList(){this.$emit("input",{friends:this.friends,selectedFriends:this.selectedFriends})}}},L=S,O=(0,p.Z)(L,a,c,!1,null,"f811e38c",null),$=O.exports,x={name:"App",components:{FriendsComponent:$},computed:{connected(){return this.$store.getters.getStatus}},data(){return{friendsList:this.$store.getters.getFriends}},watch:{friendsList:function(e){this.changeList(e)}},methods:{changeList(e){this.$store.dispatch("moveFriends",e)},login(){this.connected?this.$store.dispatch("cancelToken"):this.$store.dispatch("fetchFriends")},log(){this.$store.dispatch("logFriends")},clear(){this.$store.dispatch("cancelToken")}}},C=x,T=(0,p.Z)(C,s,o,!1,null,null,null),j=T.exports,P=n(4665),Z=n(6219),q=n.n(Z),E=n(7421),U=n.n(E),A=n(9672),J=n.n(A);const M=new(J()),N={type:"object",properties:{id:{type:"integer"},first_name:{type:"string"},last_name:{type:"string"},photo_100:{type:"string"}},required:["id","photo_100","first_name","last_name"],additionalProperties:!0};var z=M.compile(N);const D=n(375),B=8136790,R="https://oauth.vk.com/authorize",G="https://krinteron.github.io/vk_friends_list/",H=new D.Provider({id:B,authorization_url:R}),I={client_id:B,display:"popup",redirect_uri:G,scope:["offline"],response_type:"code",v:"5.131",revoke:1};r["default"].use(P.ZP);var K=new P.ZP.Store({state:{friendsList:{friends:[],selectedFriends:[]},status:"disconnected"},getters:{getFriends(e){return e.friendsList},getStatus(e){return"connected"===e.status}},mutations:{addFriends(e,t){e.friendsList.friends=[...t]},deleteFriends(e){e.friendsList.friends.splice(0),e.friendsList.selectedFriends.splice(0)},saveFriends(e,t){e.friendsList={...t}},addToSelected(e,t){e.friendsList.selectedFriends.push(t)},setStatus(e,t){e.status=t}},actions:{moveFriends({commit:e},t){e("saveFriends",t)},logFriends({getters:e}){const{selectedFriends:t}=e.getFriends;console.log(JSON.stringify(t,null,4))},fetchFriends(){const e=new D.Request(I),t=H.requestToken(e);H.remember(e),window.location.href=t},getFriends({commit:e}){const t=window.location;try{H.parse(t.hash+"&token_type=bearer");const n=H.getAccessToken();return n?new Promise((t=>{const r=U().stringify({user_id:368862537,order:"name",fields:"nickname,photo_100",name_case:"nom",access_token:n,v:5.131});q()(`https://api.vk.com/method/friends.get?${r}`,(function(n,r){if(n)console.error(n.message),e("setStatus","disconnected"),e("deleteFriends");else{e("setStatus","connected");const t=r.response.items.filter((e=>{if(z(e)){const{id:t,first_name:n,last_name:r,photo_100:i}=e;return{id:t,first_name:n,last_name:r,photo_100:i}}}));e("addFriends",t)}return t()}))})):void e("deleteFriends")}catch{}},cancelToken({commit:e}){e("setStatus","disconnected"),e("deleteFriends"),window.localStorage.clear(),window.open("https://vk.com/")}},modules:{}});r["default"].config.productionTip=!1,new r["default"]({store:K,render:e=>e(j)}).$mount("#app")},4654:function(){}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,r,i,s){if(!r){var o=1/0;for(l=0;l<e.length;l++){r=e[l][0],i=e[l][1],s=e[l][2];for(var a=!0,c=0;c<r.length;c++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](r[c])}))?r.splice(c--,1):(a=!1,s<o&&(o=s));if(a){e.splice(l--,1);var d=i();void 0!==d&&(t=d)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[r,i,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,s,o=r[0],a=r[1],c=r[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(c)var l=c(n)}for(t&&t(r);d<o.length;d++)s=o[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},r=self["webpackChunkhappy_tree_friends"]=self["webpackChunkhappy_tree_friends"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(2177)}));r=n.O(r)})();
//# sourceMappingURL=app.c7c706b3.js.map